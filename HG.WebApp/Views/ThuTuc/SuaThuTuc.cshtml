@using HG.WebApp
@{
    ViewData["Title"] = "Sổ Hồ Sơ";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    var LstPhongBan = ViewBag.LstPhongBan as List<HG.Entities.Dm_Phong_Ban>;
    var LstLinhVuc = ViewBag.LstLinhVuc as List<HG.Entities.Dm_Linh_Vuc>;
    var LstDonViLienThong = ViewBag.LstDonViLienThong as List<HG.Entities.Dm_Don_Vi_Lien_Thong>;
    var LstMucDoThucHien = ViewBag.LstMucDoThucHien as List<HG.Entities.Dm_Muc_Do_Thuc_Hien>;
}
@model HG.Entities.Entities.ThuTuc.ThuTucModel

<script src="/BackEnd/Admin/plugin/ckeditor/ckeditor.js"></script>
<style>
    .nav-pills .nav-link.active, .nav-pills .show > .nav-link {
        background: #fff;
        border-bottom: 1px solid #fff;
        color: #333;
    }

    .nav-pills .nav-link, .nav-pills .show > .nav-link {
        background: rgba(255,255,255,0.1);
        color: #fff;
        border: 0;
    }


    .nav-pills .nav-link {
        background: 0 0;
        border: 0;
        border-radius: 0;
    }
</style>
<script>
    var Arr = [];
    var Arr2 = [];
    $(document).ready(function() {
        function convetArrayToObj(serialized) {
            var FormHelper = {};
            var s = '';
            var data = {};
            for (s in serialized) {
                if (serialized[s]['name'] != 'query')
                    data[serialized[s]['name']] = serialized[s]['value']
            }
            return JSON.parse(JSON.stringify(data));
        };

        jQuery.validator.addMethod("ma_thu_tuc_vaild", function(value, element) {
            if (/[ `!#$%^&*()_+\-=\[\]{};':"\\|,<>\/?~]/.test(value)) {
                return false;
            } else {
                return true;
            };
        }, "Mã thử tục không nhập các kí tự đặc biệt [ `!#$%^&*()_+\-=\[\]{};':\\|,<>\/?~]");

        $('#form_pb').submit(function() {
            if ($("#cho_phep_lien_thong").is(':checked')) {
                if (($("#don_vi_ltxl").val() == '') && ($("#don_vi_ltph").val() == '')) {
                    alert('Bank phải chọn đơn vị liên thông phối hợp hoặc xử lý.');
                    return false;
                }
            }
            $("#form_pb").valid();
        });

        $('#form_pb').validate({
            rules: {
                ma_thu_tuc: {
                    required: true,
                    ma_thu_tuc_vaild: true
                },
                ma_quoc_gia: {
                    ma_thu_tuc_vaild: true
                },
                ten_thu_tuc: "required",
                ma_linh_vuc: "required",
                ma_phong_ban: "required",
                so_ngay_xl: "required",
                so_bo_hs: "required"
            },
            messages: {
                ma_thu_tuc: {
                    required: "Bạn cần nhập mã thủ tục!",
                },
                ten_thu_tuc: "Bạn cần nhập tên thủ tục!",
                ma_linh_vuc: "Bạn cần nhập lĩnh vực",
                ma_phong_ban: "Bạn cần nhập phòng ban",
                so_ngay_xl: "Bạn cần nhập số ngày xử lý",
                so_bo_hs: "Bạn cần nhập số bộ hồ sơ"
            }
        });



        $('.select2').select2();

        $("#nop_online").val($("#nop_online").is(':checked'));
        if ($("#nop_online").is(':checked')) {
            $(".tab_thuc_hien").attr("style", "display:flex");
        } else {
            $(".tab_thuc_hien").attr("style", "display:none");
        }

        $('#nop_online').change(function() {
            if ($(this).is(':checked')) {
                $(".tab_thuc_hien").attr("style", "display:flex")
            } else {
                $(".tab_thuc_hien").attr("style", "display:none")
            }
            $('#nop_online').val($(this).is(':checked'));
        });

        $("#hd_online").val($("#hd_online").is(':checked'));
        $('#hd_online').change(function() {
            $('#hd_online').val($(this).is(':checked'));
        });

        $("#tthcc").val($("#tthcc").is(':checked'));
        $('#tthcc').change(function() {
            $('#tthcc').val($(this).is(':checked'));
        });

        $("#tthtks").val($("#tthtks").is(':checked'));
        $('#tthtks').change(function() {
            $('#tthtks').val($(this).is(':checked'));
        });

        $("#thu_le_phi_knhs").val($("#thu_le_phi_knhs").is(':checked'));
        $('#thu_le_phi_knhs').change(function() {
            $('#thu_le_phi_knhs').val($(this).is(':checked'));
        });

        $("#thu_le_phi_kckq").val($("#thu_le_phi_kckq").is(':checked'));
        $('#thu_le_phi_kckq').change(function() {
            $('#thu_le_phi_kckq').val($(this).is(':checked'));
        });

        $("#thuc_hien_hai_gd").val($("#thuc_hien_hai_gd").is(':checked'));
        $('#thuc_hien_hai_gd').change(function() {
            $('#thuc_hien_hai_gd').val($(this).is(':checked'));
        });

        $("#tra_kq_ktn").val($("#tra_kq_ktn").is(':checked'));
        $('#tra_kq_ktn').change(function() {
            $('#tra_kq_ktn').val($(this).is(':checked'));
        });

        $("#cho_phep_lien_thong").val($("#cho_phep_lien_thong").is(':checked'));

        if ($('#cho_phep_lien_thong').is(':checked')) {
            $(".tab_lienthong").attr("style", "display:block")
        } else {
            $(".tab_lienthong").attr("style", "display:none")
        }

        $('#cho_phep_lien_thong').change(function() {
            if ($(this).is(':checked')) {
                $(".tab_lienthong").attr("style", "display:block")
            } else {
                $(".tab_lienthong").attr("style", "display:none")
            }
            $('#cho_phep_lien_thong').val($(this).is(':checked'));
        });

        $("#cho_phep_gui_lien_thong").val($("#cho_phep_gui_lien_thong").is(':checked'));
        $('#cho_phep_gui_lien_thong').change(function() {
            $('#cho_phep_gui_lien_thong').val($(this).is(':checked'));
        });

        $("#cho_phep_nhan_lien_thong").val($("#cho_phep_nhan_lien_thong").is(':checked'));
        $('#cho_phep_nhan_lien_thong').change(function() {
            $('#cho_phep_nhan_lien_thong').val($(this).is(':checked'));
        });

        $("#gui_lt_kem_kq_xl").val($("#gui_lt_kem_kq_xl").is(':checked'));
        $('#gui_lt_kem_kq_xl').change(function() {
            $('#gui_lt_kem_kq_xl').val($(this).is(':checked'));
        });

        $("#chi_tra_kq_kckqlt").val($("#chi_tra_kq_kckqlt").is(':checked'));
        $('#chi_tra_kq_kckqlt').change(function() {
            $('#chi_tra_kq_kckqlt').val($(this).is(':checked'));
        });

        var ngctxl = "@Model.thuTuc.don_vi_ltxl";
        var arrNgctxl = ngctxl.split(",");
        if (arrNgctxl != "") {
            arrNgctxl.forEach(function(i) {
                Arr.push(i);
                $("#don_vi_ltxl").val(Arr.join(","));
            });
        }
        $("#multiselect").val(arrNgctxl).trigger('change');

        $('#multiselect').on('select2:select', function(e) {
            Arr.push(e.params.data.id);
            $("#don_vi_ltxl").val(Arr.join(","));
        });

        $('#multiselect').on("select2:unselect", function(e) {
            Arr.pop(e.params.data.id);
            $("#don_vi_ltxl").val(Arr.join(","));
        });

        var ngphxl = "@Model.thuTuc.don_vi_ltph";

        var arrNgphxl = ngphxl.split(",");

        if (arrNgphxl != "") {
            arrNgphxl.forEach(function(i) {
                Arr2.push(i);
                $("#don_vi_ltph").val(Arr2.join(","));
            });
        }
        $("#multiselect2").val(arrNgphxl).trigger('change');

        $('#multiselect2').on('select2:select', function(e) {
            Arr2.push(e.params.data.id);
            $("#don_vi_ltph").val(Arr2.join(","));
        });

        $('#multiselect2').on("select2:unselect", function(e) {
            Arr2.pop(e.params.data.id);
            $("#don_vi_ltph").val(Arr2.join(","));
        });


    });

    // THÀNH PHẦN
    function ThemThanhPhan(ma_thu_tuc_key, ma_thu_tuc, type_view) {
        $.ajax({
            type: "Get",
            url: "../ThuTuc/ThemTP?code_key=" + ma_thu_tuc_key + "&code=" + ma_thu_tuc + "&type_view=" + type_view,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#TabThanhPhan").html(data);
            }
        });
    }

    //END THÀNH PHẦN
    function ThemVBLQ(ma_thu_tuc) {
        $.ajax({
            type: "Get",
            url: "../ThuTuc/ThemVBLQ?ma_thu_tuc=" + ma_thu_tuc,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#NhomVBLQ").html(data);
            }
        });
    }
    function SaveVBLQ() {
        if ($("#ten_van_ban").val() == "" || $("#ten_van_ban").val() == null) {
            $("#TitleEform").html("Tên văn bản không được bỏ trống !!!");
            $("#Notifyeform").modal("show");
            return;
        }
        var data = $("#form_vblq").serialize();
        $.ajax({
            type: "Post",
            url: "../ThuTuc/SaveVBLQ",
            data: data,
            //data: data,
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function(data) {
                $("#TitleEform").html(data);
                $("#Notifyeform").modal("show");

            }
        });
    }
    function XoaVBLQ(id) {
        if (id == "" || id == null) {
            $("#TitleEform").html("Mã văn bản liên quan không tồn tại !!!");
            $("#Notifyeform").modal("show");
            return;
        }
        $.ajax({
            type: "Get",
            url: "../ThuTuc/XoaVBLQ?id=" + id,
            data: "",
            //data: data,
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#TitleEform").html(data);
                $("#Notifyeform").modal("show");

            }
        });
    }
    function SaveAndAddVBLQ() {
        if ($("#ten_van_ban").val() == "" || $("#ten_van_ban").val() == null) {
            $("#TitleEform").html("Tên văn bản không được bỏ trống !!!");
            $("#Notifyeform").modal("show");
            return;
        }
        var data = $("#form_vblq").serialize();
        $.ajax({
            type: "Post",
            url: "../ThuTuc/SaveAndAddVBLQ",
            data: data,
            //data: data,
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function(data) {
                $("#NhomVBLQ").html(data);
                $("#TitleEform").html("Thêm văn bản liên quan thành công!!!");
                $("#Notifyeform").modal("show");
            }
        });
    }
    function SuaVBLQ(id, type) {
        $.ajax({
            type: "Get",
            url: "../ThuTuc/SuaVBLQ?id=" + id + "&type=" + type,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#NhomVBLQ").html(data);
            }
        });
    }
    //start nhom thanh phan
    function ThemNhomThanhPhan(ma_thu_tuc) {
        $.ajax({
            type: "Get",
            url: "/ThuTuc/ThemNhomThanhPhan?ma_thu_tuc=" + ma_thu_tuc,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#NhomThanhPhan").html(data);
            }
        });
    }
    function SaveNhomTP() {
        var data = $("#form_nhom_tp").serialize();
        $.ajax({
            type: "Post",
            url: "../ThuTuc/SaveNhomTP",
            data: data,
            //data: data,
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function(data) {
                $("#TitleEform").html(data);
                $("#Notifyeform").modal("show");

            }
        });
    }
    function SaveAddNhomTP() {
        var data = $("#form_nhom_tp").serialize();
        $.ajax({
            type: "Post",
            url: "../ThuTuc/SaveAddNhomTP",
            data: data,
            //data: data,
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function(data) {
                $("#NhomThanhPhan").html(data);
                $("#TitleEform").html("Thêm nhóm thành phần thành công!!!");
                $("#Notifyeform").modal("show");
            }
        });
    }
    function SuaNhomTP(id, type) {
        $.ajax({
            type: "Get",
            url: "../ThuTuc/SuaNhomTP?id=" + id + "&type=" + type,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#NhomThanhPhan").html(data);
            }
        });
    }
    function XoaNhomTP(id) {
        if (id == "" || id == null) {
            $("#TitleEform").html("Mã nhóm thành phần không tồn tại !!!");
            $("#Notifyeform").modal("show");
            return;
        }
        $.ajax({
            type: "Get",
            url: "../ThuTuc/XoaNhomTP?id=" + id,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#TitleEform").html(data);
                $("#Notifyeform").modal("show");

            }
        });
    }
    //end Nhom TP
    function ThemTPKQXL(ma_thu_tuc) {
        $.ajax({
            type: "Get",
            url: "/ThuTuc/ThemTPKQXL?ma_thu_tuc=" + ma_thu_tuc,
            data: "",
            contentType: 'application/json; charset=utf-8',
            success: function(data) {
                $("#TPKQXL").html(data);
            }
        });
    }

</script>
<div class="card">
    <div class="card-body">
        <div class="pageheader">
            <div class="pageicon"><span class="iconfa-pencil"></span></div>
            <div class="pagetitle">
                <h5>Thông tin</h5>
                <h1>Thủ tục hành chính</h1>
            </div>
        </div>
        <div class="maincontent">
            <div class="maincontentinner">
                <!-- Pills Tabs -->
                <div class="tab-primary" style="border: 2px solid #0866c6;">
                    <ul class="nav nav-pills" id="pills-tab" role="tablist" style="background: #0866c6;">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link @(ViewBag.active.Contains(ActionThuTuc.ThuTuc.ToString())?"active":"")" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-tthc" role="tab" aria-controls="pills-home" aria-selected="true">Thủ tục hành chính</button>
                        </li>
                        <li class="nav-item ui-state-default ui-corner-top" role="presentation">
                            <button class="nav-link @(ViewBag.active.Contains(ActionThuTuc.ThanhPhan.ToString())?"active":"")" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-tp" role="tab" aria-controls="pills-profile" aria-selected="false">Thành phần</button>
                        </li>
                        <li class="nav-item ui-state-default ui-corner-top" role="presentation">
                            <button class="nav-link @(ViewBag.active.Contains(ActionThuTuc.VanBanLQ.ToString())?"active":"")" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-vblq" role="tab" aria-controls="pills-profile" aria-selected="false">Văn bản liên quan</button>
                        </li>
                        <li class="nav-item ui-state-default ui-corner-top" role="presentation">
                            <button class="nav-link @(ViewBag.active.Contains(ActionThuTuc.NhomTP.ToString())?"active":"")" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-ntp" role="tab" aria-controls="pills-profile" aria-selected="false">Nhóm thành phần</button>
                        </li>
                        <li class="nav-item ui-state-default ui-corner-top" role="presentation">
                            <button class="nav-link @(ViewBag.active.Contains(ActionThuTuc.TPKQXL.ToString())?"active":"")" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-tpxlkq" role="tab" aria-controls="pills-profile" aria-selected="false">Thành phần xử lý kết quả</button>
                        </li>
                    </ul>

                    <div class="tab-content" id="myTabContent" style="padding: 15px;">
                        @*TAB Thủ tục hành chính*@
                        <div class="tab-pane fade @(ViewBag.active.Contains(ActionThuTuc.ThuTuc.ToString())?"show active":"")" id="pills-tthc" role="tabpanel" aria-labelledby="home-tab">
                            <div class="form-horizontal">
                                <!-- Horizontal Form -->
                                <form id="form_pb" action="/ThuTuc/ThemThuTuc" method="post" enctype="multipart/form-data">
                                    <input name="ma_thu_tuc_old" value="@Model.thuTuc.ma_thu_tuc_old" hidden />
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Mã luồng xử lý</label>
                                        <div class="col-sm-8">
                                            @if (Model.lstLuong != null & Model.lstLuong.Count > 0)
                                            {
                                                foreach (var item in Model.lstLuong)
                                                {
                                                    <a href="/Luong/QuyTrinhXuLy?code=@item.ma_luong">@item.ma_luong</a>
                                                }
                                            }
                                            else
                                            {
                                                <p style="color:red;">Chưa có luồng xử lý</p>
                                            }
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ma_pb" class="col-sm-2 control-label">Mã thủ tục <span style="color:red">(*)</span></label>
                                        <div class="col-sm-8">
                                            <input type="text" onfocusout="CheckMa(this)" class="form-control input-default" placeholder="Mã thủ tục" name="ma_thu_tuc" value="@Model.thuTuc.ma_thu_tuc" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                        @if (ViewBag.type_view == StatusAction.Edit.ToString())
                                        {
                                            <div class="col-sm-1">
                                                <button type="button" class="btn btn-primary" onclick="myModalPopup()" data-bs-toggle="modal" data-bs-target="#basicModal" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                    Chọn
                                                </button>

                                                <script>
                                                    function myModalPopup() {
                                                        $.ajax({
                                                            type: "GET",
                                                            url: "../ThuTuc/RenderViewThuTuc",
                                                            data: "",
                                                            contentType: 'application/json; charset=utf-8',
                                                            success: function(data) {
                                                                console.log(data);
                                                                $("#basicModal .modal-body").html(data);
                                                            }
                                                        });
                                                    }

                                                </script>
                                            </div>
                                        }

                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Mã quốc gia</label>
                                        <div class="col-sm-8">
                                            <input type="text" class="form-control input-default" placeholder="Mã chuẩn quốc gia" name="ma_quoc_gia" value="@Model.thuTuc.ma_quoc_gia" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Tên thủ tục <span style="color:red">(*)</span></label>
                                        <div class="col-sm-8">
                                            <input type="text" class="form-control input-default" placeholder="Tên thủ tục" name="ten_thu_tuc" value="@Model.thuTuc.ten_thu_tuc" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="mota" class="col-sm-2 control-label">Mô tả</label>
                                        <div class="col-sm-8">
                                            <textarea class="form-control input-default" placeholder="Mô tả" name="mo_ta" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>@Model.thuTuc.mo_ta</textarea>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="nop_online" class="col-sm-2 control-label"></label>
                                        <div class="col-sm-2">
                                            <input type="checkbox" id="nop_online" name="nop_online" value="@Model.thuTuc.nop_online" @(Model.thuTuc.nop_online==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="nop_online">Nộp Online</label>

                                        </div>
                                        <div class="col-sm-4">
                                            <input type="checkbox" id="hd_online" name="hd_online" value="@Model.thuTuc.hd_online" @(Model.thuTuc.hd_online==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="hd_online">Hướng dẫn Online</label>

                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="tthcc" class="col-sm-2 control-label"></label>
                                        <div class="col-sm-2">
                                            <input type="checkbox" id="tthcc" name="tthcc" value="@Model.thuTuc.tthcc" @(Model.thuTuc.tthcc==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="tthcc">TN tại TTHCC</label>

                                        </div>
                                        <div class="col-sm-4">
                                            <input type="checkbox" id="tthtks" name="tthtks" value="@Model.thuTuc.tthtks" @(Model.thuTuc.tthtks==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="tthtks">Thủ tục hộ tịch khai sinh</label>

                                        </div>
                                    </div>
                                    <div class="row mb-3 tab_thuc_hien">
                                        <label for="ten_pb" class="col-sm-2 control-label">Thực hiện </label>
                                        <div class="col-sm-8">
                                            <select class="form-select form-control input-default" name="thuc_hien" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <option selected="selected" value="">---- Chọn mức độ thực hiện ----</option>
                                                @if (LstMucDoThucHien != null)
                                                {
                                                    foreach (var item in LstMucDoThucHien)
                                                    {
                                                        if (item.ma_thuc_hien == Model.thuTuc.thuc_hien)
                                                        {
                                                            <option selected value="@item.ma_thuc_hien">@item.ten_thuc_hien</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@item.ma_thuc_hien">@item.ten_thuc_hien</option>
                                                        }
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Lĩnh vực <span style="color:red">(*)</span></label>
                                        <div class="col-sm-8">
                                            <select class="form-select form-control input-default" name="ma_linh_vuc" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <option selected="selected" value="">---- Chọn lĩnh vực ----</option>
                                                @if (LstLinhVuc != null)
                                                {
                                                    foreach (var item in LstLinhVuc)
                                                    {
                                                        if (item.ma_linh_vuc == Model.thuTuc.ma_linh_vuc)
                                                        {
                                                            <option selected value="@item.ma_linh_vuc">@item.ten_linh_vuc</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@item.ma_linh_vuc">@item.ten_linh_vuc</option>
                                                        }

                                                    }
                                                }

                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Phòng Ban <span style="color:red">(*)</span></label>
                                        <div class="col-sm-8">
                                            <select class="form-select form-control input-default" name="ma_phong_ban" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <option selected="selected" value="">---- Chọn phòng ban ----</option>
                                                @if (LstPhongBan != null)
                                                {
                                                    foreach (var item in LstPhongBan)
                                                    {
                                                        if (item.ma_phong_ban == Model.thuTuc.ma_phong_ban)
                                                        {
                                                            <option selected value="@item.ma_phong_ban">@item.ten_phong_ban</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@item.ma_phong_ban">@item.ten_phong_ban</option>
                                                        }

                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="so_ngay_xl" class="col-sm-2 control-label">Số ngày xử lý</label>
                                        <div class="col-sm-8">
                                            <input type="number" class="form-control input-default" name="so_ngay_xl" placeholder="Số ngày xử lý" value="@Model.thuTuc.so_ngay_xl" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="le_phi_truoc" class="col-sm-2 control-label">Lệ phí trước</label>
                                        <div class="col-sm-8">
                                            <input type="number" class="form-control input-default" name="le_phi_truoc" placeholder="Lệ phí" value="@Model.thuTuc.le_phi_truoc" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="le_phi_sau" class="col-sm-2 control-label">Lệ phí sau</label>
                                        <div class="col-sm-8">
                                            <input type="number" class="form-control input-default" name="le_phi_sau" placeholder="Lệ phí" value="@Model.thuTuc.le_phi_sau" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="so_bo_hs" class="col-sm-2 control-label">Số bộ hồ sơ</label>
                                        <div class="col-sm-8">
                                            <input type="number" class="form-control input-default" name="so_bo_hs" placeholder="Số bộ hồ sơ" value="@Model.thuTuc.so_bo_hs" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Đường dẫn phôi KQ</label>
                                        <div class="col-sm-8">
                                            <input type="text" class="form-control input-default" name="duong_dan_kq" placeholder="Đường dẫn phôi kết quả" value="@Model.thuTuc.duong_dan_kq" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Thông tin mở rộng</label>
                                        <div class="col-sm-8">
                                            <input type="text" class="form-control input-default" name="thong_tin_mo_rong" placeholder="Thông tin mở rộng" value="@Model.thuTuc.thong_tin_mo_rong" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="ten_pb" class="col-sm-2 control-label">Nội dung hướng dẫn</label>
                                        <div class="col-sm-8">
                                            <textarea id="ckedit2" class="form-control input-default" placeholder="Nội dung hướng dẫn" name="noi_dung_hd" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>@Html.Raw(Model.thuTuc.noi_dung_hd)</textarea>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="stt" class="col-sm-2 control-label">Thứ tự</label>
                                        <div class="col-sm-8">
                                            <input type="number" class="form-control input-default" name="stt" value="@Model.thuTuc.stt" placeholder="Thứ tự" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="thu_le_phi_knhs" class="col-sm-2 control-label"></label>
                                        <div class="col-sm-3">
                                            <input type="checkbox" id="thu_le_phi_knhs" name="thu_le_phi_knhs" value="@Model.thuTuc.thu_le_phi_knhs" @(Model.thuTuc.thu_le_phi_knhs==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="thu_le_phi_knhs">Thu lệ phí khi nhận hồ sơ</label>

                                        </div>
                                        <div class="col-sm-3">
                                            <input type="checkbox" id="thu_le_phi_kckq" name="thu_le_phi_kckq" value="@Model.thuTuc.thu_le_phi_kckq" @(Model.thuTuc.thu_le_phi_kckq==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="thu_le_phi_kckq">Thu lệ phí khi có kết quả</label>

                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="thu_le_phi_knhs" class="col-sm-2 control-label"></label>
                                        <div class="col-sm-3">
                                            <input type="checkbox" id="thuc_hien_hai_gd" name="thuc_hien_hai_gd" value="@Model.thuTuc.thuc_hien_hai_gd" @(Model.thuTuc.thuc_hien_hai_gd==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="thuc_hien_hai_gd">Thực hiện hai giai đoạn</label>

                                        </div>
                                        <div class="col-sm-3">
                                            <input type="checkbox" id="tra_kq_ktn" name="tra_kq_ktn" value="@Model.thuTuc.tra_kq_ktn" @(Model.thuTuc.tra_kq_ktn==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                            <label for="tra_kq_ktn">Trả kết quả khi tiếp nhận</label>

                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="cho_phep_lien_thong" class="col-sm-2 control-label">Cho phép liên thông</label>
                                        <div class="col-sm-8">
                                            <input type="checkbox" id="cho_phep_lien_thong" name="cho_phep_lien_thong" value="@Model.thuTuc.cho_phep_lien_thong" @(Model.thuTuc.cho_phep_lien_thong==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                        </div>
                                    </div>
                                    <div class="tab_lienthong" style="@(Model.thuTuc.cho_phep_lien_thong==true?"display:block":"display:none")">
                                        <div class="row mb-3">
                                            <label for="cho_phep_gui_lien_thong" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-3">
                                                <input type="checkbox" id="cho_phep_gui_lien_thong" name="cho_phep_gui_lien_thong" value="@Model.thuTuc.cho_phep_gui_lien_thong" @(Model.thuTuc.cho_phep_gui_lien_thong==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <label for="cho_phep_gui_lien_thong">Cho phép gửi liên thông</label>
                                            </div>
                                            <div class="col-sm-3">
                                                <input id="cho_phep_nhan_lien_thong" type="checkbox" name="cho_phep_nhan_lien_thong" value="@Model.thuTuc.cho_phep_nhan_lien_thong" @(Model.thuTuc.cho_phep_nhan_lien_thong==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <label for="cho_phep_nhan_lien_thong">Cho phép nhận liên thông</label>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <label for="don_vi_ltxl" class="col-sm-2 control-label">Đơn vị liên thông XL</label>
                                            <div class="col-sm-8">
                                                <select id="multiselect" class="select2 form-select form-control input-default" multiple data-placeholder="Chọn đơn vị liên thông xử lý" style="width: 100%;" tabindex="-1" aria-hidden="true" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                    @if (LstDonViLienThong != null)
                                                    {
                                                        foreach (var item in LstDonViLienThong)
                                                        {
                                                            <option value="@item.ma_don_vi">@item.ten_don_vi</option>
                                                        }
                                                    }
                                                </select>
                                                <input name="don_vi_ltxl" type="text" id="don_vi_ltxl" class="form-control input-default" hidden>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <label for="don_vi_ltph" class="col-sm-2 control-label">Đơn vị liên thông PH</label>
                                            <div class="col-sm-8">
                                                <select id="multiselect2" class="select2 form-select form-control input-default" multiple data-placeholder="Chọn đơn vị liên thông phối hợp" style="width: 100%;" tabindex="-1" aria-hidden="true" @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                    @if (LstDonViLienThong != null)
                                                    {
                                                        foreach (var item in LstDonViLienThong)
                                                        {
                                                            <option value="@item.ma_don_vi">@item.ten_don_vi</option>
                                                        }
                                                    }
                                                </select>
                                                <input name="don_vi_ltph" type="text" id="don_vi_ltph" class="form-control input-default" hidden>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <label for="gui_lt_kem_kq_xl" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-4">
                                                <input type="checkbox" id="gui_lt_kem_kq_xl" name="gui_lt_kem_kq_xl" value="@Model.thuTuc.gui_lt_kem_kq_xl" @(Model.thuTuc.gui_lt_kem_kq_xl==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <label for="gui_lt_kem_kq_xl">Gửi liên thông kèm kết quả xử lý</label>
                                            </div>
                                            <div class="col-sm-5">
                                                <input type="checkbox" id="chi_tra_kq_kckqlt" name="chi_tra_kq_kckqlt" value="@Model.thuTuc.chi_tra_kq_kckqlt" @(Model.thuTuc.chi_tra_kq_kckqlt==true?"checked":"") @(ViewBag.type_view == StatusAction.View.ToString() ? "disabled" : "")>
                                                <label for="chi_tra_kq_kckqlt">Chỉ trả kết quả khi có kết quả liên thông</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        @if (ViewBag.type_view == StatusAction.View.ToString())
                                        {
                                            <button type="button" class="btn btn-primary" name="type" onclick="window.location.href='/ThuTuc/ThemThuTuc';">Thêm</button>
                                            <button type="button" class="btn btn-primary" name="type" onclick="window.location.href='/ThuTuc/SuaThuTuc?code_key=@Model.thuTuc.ma_thu_tuc_old&code=@Model.thuTuc.ma_thu_tuc&type=@StatusAction.Edit.ToString()&active=@ActionThuTuc.ThuTuc.ToString()';">Sửa</button>
                                        }
                                        @if (ViewBag.type_view == StatusAction.Edit.ToString())
                                        {
                                            <button type="submit" class="btn btn-primary" name="type_view" value="@(StatusAction.View.ToString())">Lưu</button>
                                        }

                                        <button type="button" class="btn btn-primary" onclick="confirm.BeforDeletePost('/ThuTuc/XoaThuTuc?code=@(Model.thuTuc.ma_thu_tuc+"|"+Model.thuTuc.ma_thu_tuc_old.ToString())&type=0')">Xóa</button>
                                        <button type="button" class="btn btn-primary" onclick="confirm.BeforDeletePost('/ThuTuc/XoaThuTuc?&code=@(Model.thuTuc.ma_thu_tuc+"|"+Model.thuTuc.ma_thu_tuc_old.ToString())&type=1')">Bãi bỏ TTHC</button>
                                        <button type="button" class="btn btn-primary" onclick="window.location.href='/Thutuc/SuaThuTuc?code_key=@Model.thuTuc.ma_thu_tuc_old&code=@Model.thuTuc.ma_thu_tuc&type=@ViewBag.type_view&active=@ActionThuTuc.ThanhPhan.ToString()';">Thành phần</button>
                                        <button type="button" class="btn btn-primary" onclick="window.location.href='/Thutuc/QuanLy';">Đóng</button>
                                    </div>
                                </form>

                                <!-- End Horizontal Form -->
                            </div>
                        </div>
                        @*TAB thành phần *@
                        <div class="tab-pane fade @(ViewBag.active.Contains(ActionThuTuc.ThanhPhan.ToString())?"show active":"")" id="pills-tp" role="tabpanel" aria-labelledby="profile-tab">

                            <div id="TabThanhPhan">
                                <p class="stdformbutton" style="margin-bottom: 10px;">
                                    <input type="button" value="Thêm" onclick="ThemThanhPhan('@Model.thuTuc.ma_thu_tuc_old','@Model.thuTuc.ma_thu_tuc','@ViewBag.type_view')" class="btn btn-primary" style="width:100px;" />
                                    <input type="button" value="Xóa" onclick="DeleteMultipleTP('@Model.thuTuc.ma_thu_tuc','@Model.thuTuc.ma_thu_tuc','@ViewBag.type_view')" class="btn btn-primary" style="width:100px;" />
                                    <input hidden id="lstCode_tp" />
                                </p>
                                @*<select name="" onchange="" id="MaNhomTT" class="form-control input-default form-nhom" placeholder="Chọn nhóm...">
                                <option selected="selected" value="0">------------- Chọn nhóm thành phần hồ sơ -------------</option>
                                </select>*@
                                <div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                                    <div class="dataTable-container">
                                        <table class="table table-bordered responsive">
                                            <thead class="widgettitle">
                                                <tr>
                                                    <th class="head0 nosort" scope="col" data-sortable="" style="width: 5%;">
                                                        <input type="checkbox" name="" id="selectAll_tp" />
                                                    </th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">STT</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 20%;">TÊN</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 30%;">MÔ TẢ</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.lstThanhPhan != null)
                                                {
                                                    var stt_tp = 1;
                                                    foreach (var item in Model.lstThanhPhan)
                                                    {
                                                        <tr>
                                                            <td><input type="checkbox" class="ads_Checkbox_tp" value="@item.ma_thanh_phan" /></td>
                                                            <td scope="row">
                                                                @stt_tp
                                                                <input type="hidden" value="@item.ma_thanh_phan" />
                                                            </td>
                                                            <td><a href="javascript:void(0)" onclick="CheckMaTP(0,'','@item.ma_thanh_phan','@StatusAction.View.ToString()','@ViewBag.type_view')">@item.ten_thanh_phan</a></td>

                                                            <td>@item.mo_ta</td>
                                                            <td>
                                                                <a id="" href="javascript:void(0)" title="" data-placement="top" data-toggle="tooltip" data-original-title="Xem" onclick="CheckMaTP(0,'','@item.ma_thanh_phan','@StatusAction.View.ToString()','@ViewBag.type_view')">
                                                                    <span class="glyphicon glyphicon-list-alt">Xem</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a id="" href="javascript:void(0)" title="" data-placement="top" data-toggle="tooltip" data-original-title="Sửa" onclick="CheckMaTP(0,'','@item.ma_thanh_phan','@StatusAction.Edit.ToString()','@ViewBag.type_view')">
                                                                    <span class="glyphicon glyphicon-edit">Sửa</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a onclick="confirm.BeforDeletePost('/ThuTuc/XoaThanhPhan?code_key=@Model.thuTuc.ma_thu_tuc_old&code=@item.ma_thu_tuc&code_tp=@item.ma_thanh_phan&type=@ViewBag.type_view')"
                                                           title=""
                                                           data-placement="top"
                                                           data-toggle="tooltip"
                                                           data-original-title="Xóa"
                                                           href="#">
                                                                    <span class="glyphicon glyphicon-trash">Xóa</span>
                                                                </a>
                                                            </td>
                                                        </tr>
                                                        stt_tp++;
                                                    }

                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="dataTables_info" id="dyntable_info">Hiển thị @Model.PagelistThanhPhan.RecoredFrom đến  @Model.PagelistThanhPhan.RecoredTo của @Model.PagelistThanhPhan.TotalRecords bản ghi</div>
                                    <div class="dataTables_paginate paging_full_numbers" id="dyntable_paginate">
                                        @{
                                            var TotalPage = Model.PagelistThanhPhan.TotalPage;
                                            var CurrentPage = Model.PagelistThanhPhan.CurrentPage;
                                            if (TotalPage > 5)
                                            {
                                                if (CurrentPage > CurrentPage + 2)
                                                {
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(1)">Đầu</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPage - 1)">Trước</a></span>
                                                };
                                                if (CurrentPage > 3)
                                                {
                                                    for (int i = CurrentPage - 2; i < CurrentPage + 2; i++)
                                                    {
                                                        if (i == CurrentPage)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    for (int i = 1; i <= 5; i++)
                                                    {
                                                        if (i == CurrentPage)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }

                                                }

                                                if (CurrentPage < CurrentPage + 2)
                                                {
                                                    <span> <a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPage + 1)">Trước</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@TotalPage)">Cuối</a></span>
                                                };
                                            }
                                            else
                                            {
                                                for (int i = 1; i <= TotalPage; i++)
                                                {
                                                    if (i == CurrentPage)
                                                    {
                                                        <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                    else
                                                    {
                                                        <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                }
                                            }
                                        }
                                    </div>

                                    <!-- End Table with stripped rows -->

                                </div>
                                <p class="stdformbutton" style="margin-bottom: 10px;">
                                    <input type="button" value="Thêm" onclick="ThemThanhPhan('@Model.thuTuc.ma_thu_tuc_old','@Model.thuTuc.ma_thu_tuc','@ViewBag.type_view')" class="btn btn-primary" style="width:100px;" />
                                    <input type="button" value="Xóa" onclick="DeleteMultipleTP('@Model.thuTuc.ma_thu_tuc_old','@Model.thuTuc.ma_thu_tuc','@ViewBag.type_view')" class="btn btn-primary" style="width:100px;" />

                                </p>
                            </div>

                        </div>
                        @*TAB Văn bản liên quan *@
                        <div class="tab-pane fade @(ViewBag.active.Contains(ActionThuTuc.VanBanLQ.ToString())?"show active":"")" id="pills-vblq" role="tabpanel" aria-labelledby="profile-tab">
                            <p class="stdformbutton" style="margin-bottom: 10px;">
                                <input type="button" name="" value="Thêm" id="" onclick="ThemVBLQ('@Model.thuTuc.ma_thu_tuc')" class="btn btn-primary" style="width:100px;" />
                                <input type="button" name="" value="Xóa" id="" class="btn btn-primary" style="width:100px;" />
                            </p>
                            <div id="NhomVBLQ">
                                <div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                                    <div class="dataTable-container">
                                        <table class="table table-bordered responsive">
                                            <thead class="widgettitle">
                                                <tr>
                                                    <th class="head0 nosort" scope="col" data-sortable="" style="width: 5%;">
                                                        <input type="checkbox" name="" id="selectAll" />
                                                    </th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">STT</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 45%;">MÃ VĂN BẢN</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 45%;">TÊN</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.lstVanBanLQ != null)
                                                {
                                                    var stt = 1;
                                                    foreach (var item in Model.lstVanBanLQ)
                                                    {
                                                        <tr>
                                                            <td><input type="checkbox" class="ads_Checkbox_vplq" value="@item.ma_van_ban" /></td>
                                                            <td scope="row">
                                                                @stt++;
                                                                <input type="hidden" value="@item.ma_van_ban" />
                                                            </td>
                                                            <td><a href="#">@item.ma_thu_tuc</a></td>
                                                            <td><a href="#">@item.ten_van_ban</a></td>

                                                            <td>@item.file_dinh_kem</td>
                                                            <td>
                                                                <a id="" onclick="SuaVBLQ(@item.Id, '@StatusAction.View.ToString()')" title="" data-placement="top" data-toggle="tooltip" data-original-title="Xem" href="#">
                                                                    <span class="glyphicon glyphicon-list-alt">Xem</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a id="" onclick="SuaVBLQ(@item.Id, '@StatusAction.Edit.ToString()')" title="" data-placement="top" data-toggle="tooltip" data-original-title="Sửa" href="#">
                                                                    <span class="glyphicon glyphicon-edit">Sửa</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a onclick="XoaVBLQ(@item.Id)"
                                                           title=""
                                                           data-placement="top"
                                                           data-toggle="tooltip"
                                                           data-original-title="Xóa"
                                                           href="#">
                                                                    <span class="glyphicon glyphicon-trash">Xóa</span>
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="dataTables_info" id="dyntable_info">Hiển thị @Model.PagelistVanBanLQ.RecoredFrom đến  @Model.PagelistVanBanLQ.RecoredTo của @Model.PagelistThanhPhan.TotalRecords bản ghi</div>
                                    <div class="dataTables_paginate paging_full_numbers" id="dyntable_paginate">
                                        @{
                                            var TotalPageVblq = Model.PagelistVanBanLQ.TotalPage;
                                            var CurrentPageVblq = Model.PagelistVanBanLQ.CurrentPage;
                                            if (TotalPageVblq > 5)
                                            {
                                                if (CurrentPageVblq > CurrentPageVblq + 2)
                                                {
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(1)">Đầu</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageVblq - 1)">Trước</a></span>
                                                };
                                                if (CurrentPageVblq > 3)
                                                {
                                                    for (int i = CurrentPageVblq - 2; i < CurrentPageVblq + 2; i++)
                                                    {
                                                        if (i == CurrentPageVblq)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    for (int i = 1; i <= 5; i++)
                                                    {
                                                        if (i == CurrentPageVblq)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }

                                                }

                                                if (CurrentPageVblq < CurrentPageVblq + 2)
                                                {
                                                    <span> <a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageVblq + 1)">Trước</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@TotalPageVblq)">Cuối</a></span>
                                                };
                                            }
                                            else
                                            {
                                                for (int i = 1; i <= TotalPageVblq; i++)
                                                {
                                                    if (i == CurrentPageVblq)
                                                    {
                                                        <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                    else
                                                    {
                                                        <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                }
                                            }
                                        }
                                    </div>
                                    <!-- End Table with stripped rows -->
                                </div>
                            </div>
                        </div>
                        @*TAB Nhóm thành phần *@
                        <div class="tab-pane fade @(ViewBag.active.Contains(ActionThuTuc.NhomTP.ToString())?"show active":"")" id="pills-ntp" role="tabpanel" aria-labelledby="profile-tab">
                            <p class="stdformbutton" style="margin-bottom: 10px;">
                                <input type="button" onclick="ThemNhomThanhPhan('@Model.thuTuc.ma_thu_tuc')" name="ctl08$BtnAdd" value="Thêm" id="" class="btn btn-primary" style="width:100px;" />
                                <input type="button" name="ctl08$BtnAdd" value="Xóa" id="" class="btn btn-primary" style="width:100px;" />
                            </p>
                            <div id="NhomThanhPhan">
                                <div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                                    <div class="dataTable-container">
                                        <table class="table table-bordered responsive">
                                            <thead class="widgettitle">
                                                <tr>
                                                    <th class="head0 nosort" scope="col" data-sortable="" style="width: 5%;">
                                                        <input type="checkbox" name="" id="selectAll" />
                                                    </th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">STT</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 80%;">TÊN NHÓM</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.lstNhomTP != null)
                                                {
                                                    foreach (var item in Model.lstNhomTP)
                                                    {
                                                        <tr>
                                                            <td><input type="checkbox" class="ads_Checkbox_ntp" value="@item.ma_mhom" /></td>
                                                            <td scope="row">
                                                                1
                                                                <input type="hidden" value="@item.ma_mhom" />
                                                            </td>
                                                            <td><a onclick="SuaNhomTP(@item.Id,'@StatusAction.View.ToString()')" href="#">@item.ten_nhom</a></td>
                                                            <td>
                                                                <a id="" onclick="SuaNhomTP(@item.Id,'@StatusAction.View.ToString()')" title="" data-placement="top" data-toggle="tooltip" data-original-title="Xem" href="#">
                                                                    <span class="glyphicon glyphicon-list-alt">Xem</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a id="" title="" onclick="SuaNhomTP(@item.Id,'@StatusAction.Edit.ToString()')" data-placement="top" data-toggle="tooltip" data-original-title="Sửa" href="#">
                                                                    <span class="glyphicon glyphicon-edit">Sửa</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a onclick="XoaNhomTP(@item.Id)"
                                                           title=""
                                                           data-placement="top"
                                                           data-toggle="tooltip"
                                                           data-original-title="Xóa"
                                                           href="#">
                                                                    <span class="glyphicon glyphicon-trash">Xóa</span>
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="dataTables_info" id="dyntable_info">Hiển thị @Model.PagelistNhomTP.RecoredFrom đến  @Model.PagelistNhomTP.RecoredTo của @Model.PagelistThanhPhan.TotalRecords bản ghi</div>
                                    <div class="dataTables_paginate paging_full_numbers" id="dyntable_paginate">
                                        @{
                                            var TotalPageNtp = Model.PagelistNhomTP.TotalPage;
                                            var CurrentPageNtp = Model.PagelistNhomTP.CurrentPage;
                                            if (TotalPageNtp > 5)
                                            {
                                                if (CurrentPageNtp > CurrentPageNtp + 2)
                                                {
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(1)">Đầu</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageNtp - 1)">Trước</a></span>
                                                };
                                                if (CurrentPageNtp > 3)
                                                {
                                                    for (int i = CurrentPageNtp - 2; i < CurrentPageNtp + 2; i++)
                                                    {
                                                        if (i == CurrentPageNtp)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    for (int i = 1; i <= 5; i++)
                                                    {
                                                        if (i == CurrentPageNtp)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }

                                                }

                                                if (CurrentPageNtp < CurrentPageNtp + 2)
                                                {
                                                    <span> <a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageNtp + 1)">Trước</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@TotalPageNtp)">Cuối</a></span>
                                                };
                                            }
                                            else
                                            {
                                                for (int i = 1; i <= TotalPageNtp; i++)
                                                {
                                                    if (i == CurrentPageNtp)
                                                    {
                                                        <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                    else
                                                    {
                                                        <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                }
                                            }
                                        }
                                    </div>

                                    <!-- End Table with stripped rows -->

                                </div>
                            </div>
                        </div>
                        @*TAB Thành phần kết quả xử lý *@
                        <div class="tab-pane fade @(ViewBag.active.Contains(ActionThuTuc.TPKQXL.ToString())?"show active":"")" id="pills-tpxlkq" role="tabpanel" aria-labelledby="profile-tab">
                            <p class="stdformbutton" style="margin-bottom: 10px;">
                                <input type="button" onclick="ThemTPKQXL('@Model.thuTuc.ma_thu_tuc')" name="ctl08$BtnAdd" value="Thêm" id="" class="btn btn-primary" style="width:100px;" />
                                <input type="button" name="ctl08$BtnAdd" value="Xóa" id="" class="btn btn-primary" style="width:100px;" />
                            </p>
                            <div id="TPKQXL">
                                <div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                                    <div class="dataTable-container">
                                        <table class="table table-bordered responsive">
                                            <thead class="widgettitle">
                                                <tr>
                                                    <th class="head0 nosort" scope="col" data-sortable="" style="width: 5%;">
                                                        <input type="checkbox" name="" id="selectAll" />
                                                    </th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">STT</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 20%;">TÊN</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 30%;">MÔ TẢ</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head0" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                    <th class="head1" scope="col" data-sortable="" style="width: 5%;">#</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.lstThanhPhanKQXL != null)
                                                {
                                                    foreach (var item in Model.lstThanhPhanKQXL)
                                                    {
                                                        <tr>
                                                            <td><input type="checkbox" class="ads_Checkbox_Tpkqxl" value="@item.ma_tp_kq" /></td>
                                                            <td scope="row">
                                                                1
                                                                <input type="hidden" value="@item.ma_tp_kq" />
                                                            </td>
                                                            <td><a href="#">@item.ma_tp_kq</a></td>
                                                            <td>@item.mo_ta</td>
                                                            <td>
                                                                <a id="" title="" data-placement="top" data-toggle="tooltip" data-original-title="Xem" href="#">
                                                                    <span class="glyphicon glyphicon-list-alt">Xem</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a id="" title="" data-placement="top" data-toggle="tooltip" data-original-title="Sửa" href="#">
                                                                    <span class="glyphicon glyphicon-edit">Sửa</span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a onclick=""
                                                           title=""
                                                           data-placement="top"
                                                           data-toggle="tooltip"
                                                           data-original-title="Xóa"
                                                           href="#">
                                                                    <span class="glyphicon glyphicon-trash">Xóa</span>
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="dataTables_info" id="dyntable_info">Hiển thị @Model.PagelisthanhPhanKQXL.RecoredFrom đến  @Model.PagelisthanhPhanKQXL.RecoredTo của @Model.PagelistThanhPhan.TotalRecords bản ghi</div>
                                    <div class="dataTables_paginate paging_full_numbers" id="dyntable_paginate">
                                        @{
                                            var TotalPageTpkqxl = Model.PagelisthanhPhanKQXL.TotalPage;
                                            var CurrentPageTpkqxl = Model.PagelisthanhPhanKQXL.CurrentPage;
                                            if (TotalPageTpkqxl > 5)
                                            {
                                                if (CurrentPageTpkqxl > CurrentPageTpkqxl + 2)
                                                {
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(1)">Đầu</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageTpkqxl - 1)">Trước</a></span>
                                                };
                                                if (CurrentPageTpkqxl > 3)
                                                {
                                                    for (int i = CurrentPageTpkqxl - 2; i < CurrentPageTpkqxl + 2; i++)
                                                    {
                                                        if (i == CurrentPageTpkqxl)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    for (int i = 1; i <= 5; i++)
                                                    {
                                                        if (i == CurrentPageTpkqxl)
                                                        {
                                                            <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                        else
                                                        {
                                                            <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                        }
                                                    }

                                                }

                                                if (CurrentPageTpkqxl < CurrentPageTpkqxl + 2)
                                                {
                                                    <span> <a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@CurrentPageTpkqxl + 1)">Trước</a></span>
                                                    <span><a class="first paginate_button paginate_button_disabled" onclick="GetListByCurrentPage(@TotalPageTpkqxl)">Cuối</a></span>
                                                };
                                            }
                                            else
                                            {
                                                for (int i = 1; i <= TotalPageTpkqxl; i++)
                                                {
                                                    if (i == CurrentPageTpkqxl)
                                                    {
                                                        <span><a tabindex="0" class="active paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                    else
                                                    {
                                                        <span><a tabindex="0" class=" paginate_active" onclick="GetListByCurrentPage(@i)">@i</a></span>
                                                    }
                                                }
                                            }
                                        }
                                    </div>


                                    <!-- End Table with stripped rows -->

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- End Pills Tabs -->

    </div>
</div>
<!-- Basic Modal -->
<div class="modal fade" id="basicModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header widgettitle">
                <h5 class="modal-title">Danh sách</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- End Basic Modal-->

<script>

    CKEDITOR.replace('ckedit2');
    function CheckMa(data) {
        var dataPost = { code: data.value };
        $.ajax({
            url: "/ThuTuc/CheckMaTTHC",
            type: "post",
            contentType: 'application/x-www-form-urlencoded',
            data: dataPost,
            success: function(result) {
                window.location.href = result.href;
            }
        });
    };

    function CheckMaTP(code_key, code, data, type_view_tp, type_view) {
        var dataPost = { code_key: 0, code: "", code_tp: data, type_view_tp: type_view_tp, type_view: type_view };
        $.ajax({
            url: "/ThuTuc/CheckMaTP",
            type: "post",
            contentType: 'application/x-www-form-urlencoded',
            data: dataPost,
            success: function(result) {
                console.log(1);
                $("#TabThanhPhan").html(result);
            }
        });
    };

    function DeleteMultipleTP(code, type) {
        var listData = $("#lstCode_tp").val();
        confirm.BeforDeletePost('/ThuTuc/XoaThanhPhan?code=' + code + "&code_tp=" + listData + "&type=" + type)
    }

    $(function() {
        $('#selectAll_tp').click(function() {
            var val = [];
            if ($(this).is(':checked')) {
                $(".ads_Checkbox_tp").prop("checked", true);
                $(':checkbox:checked').each(function(i) {
                    if (i > 0) {
                        val[i - 1] = $(this).val();
                    }
                });
            }
            else {
                $(".ads_Checkbox_tp").prop("checked", false);
                val = [];
            }
            $("#lstCode_tp").val(val);
        });


        $('.ads_Checkbox_tp').click(function() {
            var val = [];
            $('.ads_Checkbox_tp:checked').each(function(i) {
                if ($('#selectAll').is(':checked')) {
                    if (i > 0) {
                        val[i - 1] = $(this).val();
                    }
                } else {
                    val[i] = $(this).val();
                }

            });
            $("#lstCode_tp").val(val);
        });

    });
</script>

<div class="modal fade" id="Notifyeform" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content" style="border: 2px solid #0866c6;">
            <div class="modal-header" style="background-color: #0866c6;">
                <h5 class="modal-title" style="color:white" id="exampleModalLabel">Thông báo</h5>
            </div>
            <div class="modal-body" id="TitleEform">
                Lưu biểu mẫu thành công !!!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-footer-btnclose" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<!-- Basic Modal -->
<div class="modal fade" id="basicModal_TP" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header widgettitle">
                <h5 class="modal-title">Danh sách</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body basicModaltp_ct">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>